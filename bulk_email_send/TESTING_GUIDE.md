# 一括メール送信ツール - テストガイド

## 目的

このガイドは、一括メール送信ツールが正しく動作することを確認するためのテスト手順です。重要なメールキャンペーンで使用する前に、必ずテストを実施してください。

---

## テスト開始前のチェックリスト

テストを始める前に、以下を準備してください：

- [ ] NetSuite へのアクセス権限
- [ ] 一括メール送信フォームの URL
- [ ] 少なくとも1つの Email Template が作成済み
- [ ] 自分のメールアドレスだけを含むテスト用 Saved Search
- [ ] E-Mail Attachments フォルダにテスト用ファイル（任意）

---

## テストシナリオ 1: シンプルなメール送信（添付なし）

**目的**: 基本的なメールを自分宛てに送信

### 手順:

1. 一括メール送信フォームを開く
2. 以下のように入力：
   - **Email Template**: 任意のテンプレートを選択
   - **Saved Search**: 自分のメールアドレス**のみ**を返す検索を選択
   - **Sender Name**: デフォルトのまま（TOKYO FOOD Co., LTD）
   - **Employee (for Reply-To)**: デフォルトのまま（自分）
   - **Reply-To**: 自分のメールアドレスが自動入力されることを確認
   - **Attachments**: 空のまま
   - **Subject Override**: 空のまま
3. **Preview Recipients** をクリック
4. プレビューリストに自分のメールアドレスが表示されることを確認
5. **Send Emails** をクリック
6. 確認ダイアログで確認
7. 確認画面の **Task ID** と **タイムスタンプ** をメモ
8. 2〜5分待つ
9. 自分のメール受信箱を確認

### 期待される結果:
- ✅ 5分以内にメールが届く（受信者用）
- ✅ **確認メールがReply-To Addressに1通届く**
- ✅ 件名が Email Template と一致
- ✅ 本文が Email Template と一致
- ✅ 送信者名が「TOKYO FOOD Co., LTD」と表示される
- ✅ Reply-To アドレスが正しい（返信をクリックして確認）
- ✅ 添付ファイルなし

---

## テストシナリオ 2: 添付ファイル付きメール

**目的**: ファイル添付機能のテスト

### 手順:

1. 一括メール送信フォームを開く
2. 以下のように入力：
   - **Email Template**: 任意のテンプレートを選択
   - **Saved Search**: 同じテスト用検索（自分のメールのみ）
   - **Sender Name**: デフォルトのまま（TOKYO FOOD Co., LTD）
   - **Employee (for Reply-To)**: デフォルトのまま（自分）
   - **Reply-To**: 自動入力される
   - **Attachments**: 1〜2個のテストファイルを選択
   - **Subject Override**: 空のまま
3. **Preview Recipients** をクリック
4. 自分のメールアドレスが表示されることを確認
5. **Send Emails** をクリック
6. 確認して Task ID をメモ
7. 2〜5分待つ
8. 自分のメール受信箱を確認

### 期待される結果:
- ✅ 5分以内にメールが届く
- ✅ **確認メールがReply-To Addressに1通届く**
- ✅ 添付ファイルが含まれている（受信者用メールと確認メールの両方）
- ✅ 添付ファイルを開く/ダウンロードできる
- ✅ その他の項目はテスト1と同じく正しい

---

## テストシナリオ 3: 件名の上書き

**目的**: カスタム件名のテスト

### 手順:

1. 一括メール送信フォームを開く
2. 以下のように入力：
   - **Email Template**: 任意のテンプレートを選択
   - **Saved Search**: テスト用検索を使用
   - **Sender Name**: デフォルトのまま（TOKYO FOOD Co., LTD）
   - **Employee (for Reply-To)**: デフォルトのまま（自分）
   - **Reply-To**: 自動入力される
   - **Attachments**: 空のまま
   - **Subject Override**: 「テスト - カスタム件名」と入力
3. **Send Emails** をクリック
4. 確認して Task ID をメモ
5. 自分のメール受信箱を確認

### 期待される結果:
- ✅ メールの件名が「テスト - カスタム件名」
- ✅ メールの本文はテンプレートと一致
- ✅ その他の項目は正しい

---

## テストシナリオ 4: Sender Name のカスタマイズ

**目的**: カスタム送信者名表示のテスト

### 手順:

1. 一括メール送信フォームを開く
2. 以下のように入力：
   - **Email Template**: 任意のテンプレートを選択
   - **Saved Search**: テスト用検索を使用（自分のみ）
   - **Sender Name**: 「Sales Team」と入力
   - **Employee (for Reply-To)**: デフォルトのまま（自分）
   - **Reply-To**: 自動入力される
   - **Attachments**: 空のまま
   - **Subject Override**: 空のまま
3. **Send Emails** をクリック
4. 確認して Task ID をメモ
5. 自分のメール受信箱を確認

### 期待される結果:
- ✅ メールが届く
- ✅ 送信者名が「Sales Team」と表示される
- ✅ Reply-To アドレスは自分のメールアドレス
- ✅ 返信をクリックすると、自分のアドレスに送られる
- ✅ **確認メールが1通届く**

---

## テストシナリオ 5: Employee の変更

**目的**: Reply-To 従業員変更機能のテスト

### 手順:

1. 一括メール送信フォームを開く
2. 以下のように入力：
   - **Email Template**: 任意のテンプレートを選択
   - **Saved Search**: テスト用検索を使用（自分のみ）
   - **Sender Name**: デフォルトのまま（TOKYO FOOD Co., LTD）
   - **Employee (for Reply-To)**: **別の従業員**を選択（自分以外）
   - **Reply-To**: 新しい従業員のメールアドレスに自動変更されることを確認
   - **Attachments**: 空のまま
   - **Subject Override**: 空のまま
3. Reply-To フィールドが自動的に更新されたことを確認
4. **Send Emails** をクリック
5. 確認して Task ID をメモ
6. 自分と選択した従業員のメール受信箱を確認

### 期待される結果:
- ✅ 自分にメールが届く（受信者として）
- ✅ 選択した従業員に**確認メールが1通届く**
- ✅ 送信者名が「TOKYO FOOD Co., LTD」と表示される
- ✅ Reply-To アドレスが選択した従業員のメールアドレス
- ✅ 返信をクリックすると、選択した従業員に送られる

---

## テストシナリオ 6: 複数の受信者と確認メール

**目的**: 2〜3人への送信テスト＋確認メール機能の検証

### 準備:
1. 2〜3人の同僚のメールアドレスを含むテスト用 Saved Search を作成
2. **重要**: 同僚にテストを行うことを事前に伝えてください

### 手順:

1. 一括メール送信フォームを開く
2. 以下のように入力：
   - **Email Template**: 件名に「TEST」が含まれるテンプレートを選択
   - **Saved Search**: 2〜3人用のテスト検索を選択
   - **Sender Name**: デフォルトのまま（TOKYO FOOD Co., LTD）
   - **Employee (for Reply-To)**: デフォルトのまま（自分）
   - **Reply-To**: 自動入力される
   - **Attachments**: 空のままか、1ファイル追加
   - **Subject Override**: テンプレートにテストの記載がない場合は「テスト - 無視してください」と入力
3. **Preview Recipients** をクリック
4. 2〜3件のメールアドレスが正しく表示されることを確認
5. **Send Emails** をクリック
6. 確認して Task ID をメモ
7. 同僚に受信確認を依頼（10分以内）
8. 自分のメール受信箱で確認メールを確認

### 期待される結果:
- ✅ すべての受信者が10分以内にメールを受信
- ✅ **確認メールがReply-To Address（自分）に1通だけ届く**（受信者の数に関係なく1通のみ）
- ✅ 確認メールは最後に届く（受信者へのメール送信完了後）
- ✅ すべてのメールが同一内容
- ✅ すべての詳細（送信者、返信先、添付ファイル）が正しい

---

## テストシナリオ 7: リセット機能

**目的**: Reset ボタンのテスト

### 手順:

1. 一括メール送信フォームを開く
2. いくつかのフィールドに入力（送信しない）
3. **Reset** ボタンをクリック
4. リセットを確認

### 期待される結果:
- ✅ すべてのフィールドがクリアされる
- ✅ フォームが初期状態に戻る
- ✅ メールは送信されていない

---

## テストシナリオ 7: バリデーションチェック

**目的**: 必須フィールドが正しく機能しているかテスト

### 手順:

1. 一括メール送信フォームを開く
2. **Email Template** を空のままにする
3. **Send Emails** をクリック
4. **期待される結果**: エラーメッセージ「Please select an Email Template」
5. Email Template を入力
6. **Saved Search** を空のままにする
7. **Send Emails** をクリック
8. **期待される結果**: エラーメッセージ「Please select a Saved Search」
9. 他の必須フィールドについても繰り返す：
   - **Sender**
   - **Reply-To Address**

### 期待される結果:
- ✅ Email Template なしでは送信できない
- ✅ Saved Search なしでは送信できない
- ✅ Sender なしでは送信できない
- ✅ Reply-To Address なしでは送信できない
- ✅ Attachments なしでも送信できる（任意項目）
- ✅ Subject Override なしでも送信できる（任意項目）

---

## テスト中のトラブルシューティング

### 問題: 10分経ってもメールが届かない

**確認事項:**
1. 迷惑メール/スパムフォルダを確認
2. Saved Search のメールアドレスは正しいか？
3. Task ID をメモしましたか？それを持って管理者に連絡

**試してみる:**
- 別の自分のメールアドレスにテスト送信してみる

### 問題: Reply-To フィールドが自動入力されない

**試してみる:**
1. 別の Sender を選択
2. 元の Sender を再選択
3. フィールドが入力されるはず

**それでも空の場合:**
- 手動で Reply-To アドレスを入力
- 管理者に報告

### 問題: メールに添付ファイルがない

**確認事項:**
1. ファイルは **E-Mail Attachments** フォルダに入っているか？
2. フォームで実際に選択したか？
3. ファイルサイズが大きすぎないか？（NetSuite にはサイズ制限があります）

**試してみる:**
- より小さいファイル（10MB以下）を使用
- 1つだけ添付してテスト

### 問題: 間違った送信者名が表示される

**確認事項:**
- フォームで正しい Sender を選択したか？
- 名前は NetSuite の Employee レコードから取得されます

**注意:**
- 実際の送信アドレスは常に `no-reply@tokyofood.co.nz` です
- 表示名（送信者名）のみが変わります
- 外部SMTPサーバー（mss52.kagoya.net）経由で送信されます

---

## テスト結果記録用テンプレート

このチェックリストを使ってテスト結果を記録してください：

```
テスト実施日: _______________
テスト実施者: _______________

[ ] テスト1: シンプルなメール送信 - 合格 / 不合格
    備考: _________________________________

[ ] テスト2: 添付ファイル付きメール - 合格 / 不合格
    備考: _________________________________

[ ] テスト3: 件名の上書き - 合格 / 不合格
    備考: _________________________________

[ ] テスト4: 送信者の変更 - 合格 / 不合格
    備考: _________________________________

[ ] テスト5: 複数の受信者 - 合格 / 不合格
    備考: _________________________________

[ ] テスト6: リセット機能 - 合格 / 不合格
    備考: _________________________________

[ ] テスト7: バリデーションチェック - 合格 / 不合格
    備考: _________________________________

総合評価: 本番利用可能 / 修正が必要

発見された問題:
1. _________________________________
2. _________________________________
3. _________________________________
```

---

## 問題の報告方法

テスト中に問題を発見した場合：

1. 重大な問題の場合は**テストを中止**
2. **問題を記録**:
   - 何をしようとしていたか（どのテストシナリオか）
   - 実際に何が起きたか
   - エラーメッセージ（スクリーンショットを撮る）
   - Task ID（送信ステップまで進んだ場合）
3. 上記の情報を持って**管理者に連絡**
4. 問題が解決するまで**本番では使用しない**

---

## 承認

すべてのテストが合格したら：

```
テスト完了者: _______________
日付: _______________
署名: _______________

本番利用承認: はい / いいえ

承認者: _______________
日付: _______________
```

---

## テストを成功させるためのヒント

1. **テストデータのみを使用** - 実際の顧客リストでテストしない
2. **業務時間外にテスト** - ピーク時を避ける
3. **小規模から始める** - 大規模グループの前に1〜3人でテスト
4. **メモを取る** - うまくいったこと、いかなかったことを記録
5. **質問する** - おかしいと思ったら、続行する前に質問
6. **焦らない** - メールが届くまで数分かかることがあります

---

*最終更新日: 2025年11月2日*
